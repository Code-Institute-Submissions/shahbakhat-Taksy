{% extends 'passenger/base.html' %}
{% load bootstrap5 %}

{% block head %}
<link rel="stylesheet" href="checkout.css" />
<script src="https://js.stripe.com/v3/"></script>
<script src="checkout.js" defer></script>
  <style>
        #setup-form{
                padding:2rem;
            }
            .StripeElement {
                height:40px;
                padding:10px 12px;
                width:100%;
                background-color=white;
                border :1px solid #ced4da;
                {% comment %} border:1px solid transparent; {% endcomment %}
                border-radius:4px;

                {% comment %} box-shadow: 01px 3px 0 #e6ebf1;
                -webkit-trnsition: box-shadow 150ms ease;
                transition: box-shadow 150ms ease; {% endcomment %}
            }
            .StripeElement--focus {
                border-color:#80bdff;
                box-shadow:0 0 0 0.2rem rgba(0,123,255,.25);
            }
            .StripeElement--invalid{
                border-color: #fa755a;
            }
            .StripeElement--webkit-autofil {
                background-color:#fefde5 !important;
            }
</style> 

{% endblock %}
{% block main %}

<b class="text-secomdary">Your Credit/Debit Card</b>
    <div class="card bg-white ">
       <div class="card-body">
        <form id="payment-form">
            <div id="card-element">
              <!-- Elements will create input elements here -->
            </div>

            <!-- We'll put the error messages in this element -->
            <div id="card-errors" role="alert"></div>

            <button id="submit" class="btn btn-warning mt-3">Save Card</button>
          </form>
    </div>

<script>
// This is a public sample test API key.
// Donâ€™t submit any personally identifiable information in requests made with this key.
// Sign in to see your own test API key embedded in code samples.
const stripe = Stripe('pk_test_51NAzY8EsGHfqk8451iqCC67T8GcG6tDPK8A66XDilpL5mLpc9ISAm17evseykIO3At4Z44Pcsh0VnLb9JrbDfegN00WWmYU9Dj');

(async () => {
    const response = await fetch('/secret');
    const {client_secret: clientSecret} = await response.json();
    // Render the form to collect payment details, then
    // call stripe.confirmCardPayment() with the client secret.
  })();
  var elements = stripe.elements();
  var style = {
    base: {
      color: "#32325d",
    }
  };
  
  var card = elements.create("card", { style: style });
  card.mount("#card-element");

  card.on('change', ({error}) => {
    let displayError = document.getElementById('card-errors');
    if (error) {
      displayError.textContent = error.message;
    } else {
      displayError.textContent = '';
    }
  });

</script>
{% endblock %}